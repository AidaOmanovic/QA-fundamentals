SELECT * FROM (SELECT aa.*, ROW_NUMBER() OVER (ORDER BY 1) LINENUM FROM (select a.*, ROWNUM rnum from (select bcd.id id, par.id branch_id, par.name branch, am.ucode account_ucode, am.name account_name, spc.customer_name sap_customer_name, spc.sap_account sap_customer_ucode, spc.address sap_address, bcd.document_number invoice_number, bcd.original_amount invoice_amount, bcd.document_dt invoice_dt, bcd.due_dt invoice_pay_dt, dp.criminal_registration_dt criminal_registration_dt, dp.criminal_registration_ucode criminal_registration_ucode, null dispute_amount, null lawsuit_state, dp.verdict_dt verdict_dt, null verdict_sec_instance_dt, null verdict_status, dp.notice, dp.up_relocation_type_id, dp.usage_point_movement_date, dp.usage_point_movement_notice, dp.is_self_connected from theft_du_periods dp join bc_documents bcd on bcd.id = dp.billing_document_id join theft_sap_customers spc on dp.sap_customer_id = spc.id join am_accounts am on am.id = dp.account_id left join am_document_balance adb on adb.bc_document_id = bcd.id join sec_scopes sc on am.sec_scope_id = sc.id join sec_scopes par on par.id = sc.parent_id WHERE 1=1 AND 1=1 AND trim(upper(am.ucode)) like '%'|| trim(upper('141000233')) ||'%' AND 1=1 AND 1=1 AND 1=1) a )aa ) WHERE LINENUM BETWEEN 1 AND 20